(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["main-chartiq"],{"1aa1":function(t,e,s){"use strict";var r=s("ba6a"),i=s("5665");function a(t){return r["a"].get(Object(i["a"])("preferences.all"),{params:t})}function n(t){return r["a"].post(Object(i["a"])("preferences.update"),t)}var o={getTours:a,updateTours:n},c=s("5fb0"),h=s("b202");function u(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function l(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?u(Object(s),!0).forEach((function(e){d(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function d(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}let m=!0;const p="tour";let b=["default","order","table","notification","marketdepth","chart"],g={};b.forEach(t=>{g[t]=!0});const k={tours:Object(h["b"])(p,"tours")||null,toursError:null,toursFetchStatus:c["a"].initial},f={tours:t=>t.tours,toursError:t=>t.toursError,toursFetchStatus:t=>t.toursFetchStatus},C={setTours(t,e){t.tours=e,Object(h["d"])(p,"tours",e)},setDefaultTours(t){t.tours=g,Object(h["d"])(p,"tours",t.tours)},setTour(t,{name:e,value:s}){t.tours=l(l({},t.tours),{},{[e]:s}),Object(h["d"])(p,"tours",t.tours)},setToursError(t,e){t.toursError=e},setToursFetchStatus(t,e){t.toursFetchStatus=e},clearTours(t){t.tours=g,Object(h["d"])(p,"tours",g)}},O={fetchTours({commit:t,state:e}){t("setToursFetchStatus",c["a"].fetching);let s={key:"tours"};o.getTours(s).then(e=>{e&&e.data&&e.data.data&&e.data.data.tours&&t("setTours",JSON.parse(e.data.data.tours)),t("setToursFetchStatus",c["a"].success)}).catch(e=>{t("setToursFetchStatus",c["a"].error)})},updateTours({commit:t,state:e}){let s={key:"tours",value:JSON.stringify(e.tours)};o.updateTours(s)}};var y={state:k,getters:f,mutations:C,actions:O,namespaced:m};s.d(e,"a",(function(){return v}));class v{}v.namespace=p,v.install=function(t,e){e.store&&e.store.registerModule(p,y)}},"2a87":function(t,e,s){"use strict";const r="chart";e["a"]={NAMESPACE:r}},"7bdc":function(t,e,s){"use strict";s.d(e,"b",(function(){return c}));var r=s("c6c3"),i=s("dba6"),a=s("5fb0"),n=s("025e");let o=!0;const c=i["a"],h={positions:null,positionsError:null,positionsFetchStatus:a["a"].initial},u={positions:t=>t.positions,positionsError:t=>t.positionsError,positionsFetchStatus:t=>t.positionsFetchStatus},l={setPositions(t,e){t.positions=e},setPositionsError(t,e){t.positionsError=e},setPositionsFetchStatus(t,e){t.positionsFetchStatus=e}},d={fetchPositions({commit:t,state:e}){t("setPositionsFetchStatus",a["a"].fetching);let s=r["a"].getPositions();Object(n["f"])({commit:t,apiPromise:s,data:"setPositions",error:"setPositionsError",status:"setPositionsFetchStatus"})}};e["a"]={state:h,getters:u,mutations:l,actions:d,namespaced:o}},"98c7":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"chart-frame"},[s("iframe",{attrs:{id:"chart-iframe",src:t.chartURL}})])])},i=[],a=s("e165"),n=s.n(a),o=s("2a87"),c=s("025e"),h=s("d9d2"),u=s("0a56"),l=s("2f62");function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function m(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){p(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function p(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var b={name:"chart-page",inject:["instrumentManager","ticker","userId","encToken"],props:["token","segment","tradingsymbol"],data(){return{lastPrice:null,chartParams:{},chartFrame:null,routeWatcher:null,windowHeight:null,chartBaseURL:"/static/build/multiple-chart.html?v=2.9.10"}},created(){Object(c["m"])("resize","optimizedResize"),window.addEventListener("optimizedResize",this.setWindowHeight),this.$emit("currentChart",!0)},mounted(){this.$nextTick(()=>{this.setWindowHeight(),this.updateChartURL(),this.chartFrame=this.$el.querySelector("#chart-iframe"),this.chartFrame.addEventListener("load",()=>{this.chartFrame.contentWindow.kiteAPI={placeOrder:this.placeOrderCallback,subscribeTicks:this.subscribeTicksCallback,unsubscribeTicks:this.unsubscribeTicksCallback,changeSymbol:null,onChangeSymbol:this.onChangeSymbol,instrumentManager:this.instrumentManager},window.chartFrame=this.chartFrame,window.setLiveTicks=this.chartFrame.contentWindow.setLiveTicks,window.kiteAPI={},window.kiteAPI.refreshCurrentChart=this.chartFrame.contentWindow.refreshCurrentChart,window.kiteAPI.changeSymbol=this.chartFrame.contentWindow.changeSymbolFromParent})})},beforeDestroy(){window.removeEventListener("optimizedResize",this.setWindowHeight)},watch:{$route(){this.updateChartURL(this.$route.params)},ticks(t){t[this.token]&&t[this.token].lastPrice&&t[this.token].lastPrice!==this.lastPrice&&(this.lastPrice=t[this.token].lastPrice),t[this.token]&&this.chartFrame&&this.chartFrame.contentWindow&&this.chartFrame.contentWindow.setLiveTicks&&this.chartFrame.contentWindow.setLiveTicks({[this.token]:t[this.token]})}},computed:m(m({},Object(l["c"])(u["a"].namespace,["ticks"])),{},{chartURLFragment(){return"#enctoken={encToken}&user_id={userId}&access_token={accessToken}&api_key={apiKey}&source={source}&multiple={multiple}&mc={mc}"},chartURL(){let t=this.chartURLFragment;return"externalChart"===this.$route.name?t+="&full=true":t+="&inapp=true",this.chartBaseURL+n()(t,this.chartParams)},customClass(){let t=!0,e=!1;return"externalChart"===this.$route.name&&(e=!0,t=!1),{"full-chart":e,inapp:t}},showInstrumentInfo(){return!("externalChart"===this.$route.name||!this.ticks[this.token])}}),methods:{getInstrument(t,e){return this.instrumentManager.get(t,e)},updateChartURL(t){let e={userId:this.userId,accessToken:this.$route.query.access_token,apiKey:this.$route.query.api_key,source:this.$route.query.source,multiple:this.$route.query.multiple,mc:this.$route.query.mc,encToken:encodeURIComponent(this.encToken)};this.chartParams=e,this.postIframeMessage(e)},postIframeMessage(t){this.chartFrame&&this.chartFrame.contentWindow&&this.chartFrame.contentWindow.kiteAPI&&this.chartFrame.contentWindow.kiteAPI.changeSymbol?this.chartFrame.contentWindow.kiteAPI.changeSymbol({token:t.token,segment:t.segment,symbol:encodeURIComponent(t.tradingsymbol)}):this.chartFrame&&this.chartFrame.contentWindow&&this.chartFrame.contentWindow.location.reload()},setWindowHeight(){let t=this.$el&&this.$el.querySelector("#chart-iframe");t&&(t.style.height=window.innerHeight-t.getBoundingClientRect().top+"px")},subscribeTicksCallback(t){if(t&&t.token){let e=[parseInt(t.token)];this.ticker.subscribe(e,o["a"].NAMESPACE),this.ticker.setMode(this.ticker.modeFull,e,o["a"].NAMESPACE)}},unsubscribeTicksCallback(t){if(t&&t.token){let e=[parseInt(t.token)];this.ticker.unsubscribe(e,o["a"].NAMESPACE)}},placeOrderCallback(t){let e=this.instrumentManager.get(t.tradingsymbol.toUpperCase(),t.segment);this.$events.emit(h["b"].EVENTS.ORDER_PLACE,{instrument:e,transactionType:t.transactionType.toUpperCase(),quantity:e.lotSize||1,price:t.price||0,lastPrice:t.price||0})},onChangeSymbol(t){"externalChart"===this.$route.name?this.$router.push({name:"externalChart",params:t}):"chart"===this.$route.name&&this.$router.push({name:"chart",params:t})},setPageTitle(t,e,s){let r=t+" ("+e+") ";s&&(r+=s),document.title=r+" - Kite Chart"}}},g=b,k=s("2877"),f=Object(k["a"])(g,r,i,!1,null,null,null);e["default"]=f.exports},a034:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chart-wrapper"},[s("div",{staticClass:"chart-container"},[t.chartURL?s("div",{staticClass:"chart-frame chart-page"},[s("iframe",{attrs:{id:"chart-iframe",src:t.chartURL}})]):t._e()]),t._v(" "),t.showInstrumentInfo?s("div",{staticClass:"instrument-market-data"},[s("div",{staticClass:"row"},[s("div",{staticClass:"three columns"},[s("div",{staticClass:"label"},[t._v("Open")]),t._v(" "),t.ticks[t.token].openPrice?s("div",{staticClass:"value"},[t._v(t._s(t.ticks[t.token].openPrice))]):s("div",{staticClass:"value"},[t._v("—")])]),t._v(" "),s("div",{staticClass:"three columns"},[s("div",{staticClass:"label"},[t._v("High")]),t._v(" "),t.ticks[t.token].highPrice?s("div",{staticClass:"value"},[t._v(t._s(t.ticks[t.token].highPrice))]):s("div",{staticClass:"value"},[t._v("—")])]),t._v(" "),s("div",{staticClass:"three columns"},[s("div",{staticClass:"label"},[t._v("Low")]),t._v(" "),t.ticks[t.token].lowPrice?s("div",{staticClass:"value"},[t._v(t._s(t.ticks[t.token].lowPrice))]):s("div",{staticClass:"value"},[t._v("—")])]),t._v(" "),s("div",{staticClass:"three columns"},[s("div",{staticClass:"label"},[t._v("Close")]),t._v(" "),t.ticks[t.token].closePrice?s("div",{staticClass:"value"},[t._v(t._s(t.ticks[t.token].closePrice))]):s("div",{staticClass:"value"},[t._v("—")])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"three columns"},[s("div",{staticClass:"label"},[t._v("Volume")]),t._v(" "),t.ticks[t.token].volume?s("div",{staticClass:"value"},[t._v(t._s(t.ticks[t.token].volume))]):s("div",{staticClass:"value"},[t._v("—")])]),t._v(" "),s("div",{staticClass:"three columns"},[s("div",{staticClass:"label"},[t._v("Avg. trade price")]),t._v(" "),t.ticks[t.token].averagePrice?s("div",{staticClass:"value"},[t._v(t._s(t.ticks[t.token].averagePrice))]):s("div",{staticClass:"value"},[t._v("—")])]),t._v(" "),s("div",{staticClass:"three columns"},[s("div",{staticClass:"label"},[t._v("Total buy quantity")]),t._v(" "),t.ticks[t.token].totalBuyQuantity?s("div",{staticClass:"value"},[t._v(t._s(t.ticks[t.token].totalBuyQuantity))]):s("div",{staticClass:"value"},[t._v("—")])]),t._v(" "),s("div",{staticClass:"three columns"},[s("div",{staticClass:"label"},[t._v("Total sell quantity")]),t._v(" "),t.ticks[t.token].totalSellQuantity?s("div",{staticClass:"value"},[t._v(t._s(t.ticks[t.token].totalSellQuantity))]):s("div",{staticClass:"value"},[t._v("—")])])])]):t._e()])},i=[],a=s("a026"),n=s("e165"),o=s.n(n),c=s("b23e"),h=s.n(c),u=s("2f62"),l=s("b202"),d=s("5fb0"),m=s("c0d6"),p=s("1aa1"),b=s("da42"),g=s("0a56"),k=s("c2fb"),f=s("808c"),C=s("d9d2"),O=s("ba6a"),y=s("5665");function v(t){return t?O["a"].get(Object(y["a"])("orders.info",{orderId:t})):O["a"].get(Object(y["a"])("orders.all"))}function T(){return O["a"].get(Object(y["a"])("trades.all"))}function w(t){return O["a"].get(Object(y["a"])("orders.trades",{orderId:t}))}function P(t){return O["a"].post(Object(y["a"])("orders.place",{variety:t.variety}),t)}function S(t,e){return O["a"].put(Object(y["a"])("orders.modify",{orderId:t,variety:e.variety}),e)}function E(t,e){return O["a"].delete(Object(y["a"])("orders.cancel",{orderId:t,variety:e.variety}),{params:e})}function _(t,e){return O["a"].get(Object(y["a"])("orders.triggerRange",{transactionType:t}),{params:e})}function R(t){return O["a"].post(Object(y["a"])("gtt_orders.place"),t)}function I(t,e){return O["a"].put(Object(y["a"])("gtt_orders.modify",{orderId:t}),e)}function F(t,e){return O["a"].delete(Object(y["a"])("gtt_orders.cancel",{orderId:t}),{params:e})}function j(t){return t?O["a"].get(Object(y["a"])("gtt_orders.info",{orderId:t})):O["a"].get(Object(y["a"])("gtt_orders.all"))}function M(t){return O["a"].post(Object(y["a"])("nudge.orders"),t,{headers:{"Content-Type":"application/json"}})}var $={getOrders:v,getTrades:T,getOrderTrades:w,placeOrder:P,cancelOrder:E,modifyOrder:S,getTriggerRange:_,placeGTT:R,modifyGTT:I,deleteGTT:F,getGTT:j,checkOrdersNudge:M},L=s("2a87"),A=s("025e"),D=s("714b"),N=s("f8fb"),W=s("aada"),U=s("6825");function q(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function x(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?q(Object(s),!0).forEach((function(e){V(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):q(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function V(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}a["a"].use(f["a"]),a["a"].use(p["a"],{store:m["a"]}),a["a"].use(g["a"],{store:m["a"]}),a["a"].use(b["a"],{store:m["a"]}),a["a"].use(k["a"],{store:m["a"]}),a["a"].component("modal",D["a"]),a["a"].component("empty-state",W["a"]),a["a"].component("error-state",N["a"]),a["a"].component("context-menu",U["a"]);class z{constructor(t){V(this,"tagPrefix","chart_"),V(this,"modeFull","full"),V(this,"modeQuote","quote"),V(this,"modeLTP","ltp"),V(this,"subscribedTokens",{}),this.crosstabClient=t,this.crosstabClient.emit(d["c"].CROSSTAB_CHANNELS.getTicks,!0,!0)}resubscribe(){for(let t in this.subscribedTokens)this.subscribe([t],this.subscribedTokens[t]["tag"]),this.setMode(this.subscribedTokens[t]["mode"],[t],this.subscribedTokens[t]["tag"])}subscribe(t,e){let s={type:"subscribe",tokens:t,tag:this.tagPrefix+e};for(let r of t)this.subscribedTokens[parseInt(r)]={tag:this.tagPrefix+e,mode:this.modeQuote};this.sendMessage(s)}unsubscribe(t,e){let s={type:"unsubscribe",tokens:t,tag:this.tagPrefix+e};for(let r of t)delete this.subscribedTokens[parseInt(r)];this.sendMessage(s)}setMode(t,e,s){let r={type:"setMode",mode:t,tokens:e,tag:this.tagPrefix+s};for(let i of e)this.subscribedTokens[parseInt(i)]={tag:this.tagPrefix+s,mode:t};this.sendMessage(r)}getQuote(){return new Promise((function(t,e){return e(new Error("Not implemented"))}))}sendMessage(t){this.crosstabClient.emit(d["c"].CROSSTAB_CHANNELS.ticker,t)}}const B="chart-frame";var H={name:"chart-page",inject:["instrumentManager","ticker","userId","encToken"],props:["token","segment","tradingsymbol"],provide(){return{ticker:this.ticker,userId:this.userId,publicToken:this.publicToken,instrumentManager:this.instrumentManager,encToken:this.encToken,reactive:{extendedTicker:this.extendedTicker}}},data(){return{drawerWidth:350,showOrders:!0,showDrawer:!1,showPositions:!0,showMarketDepth:!0,isInstrumentsLoaded:!1,enableDrawer:!0,subscribedTokens:new Set,lastPrice:null,chartParams:{},chartFrame:null,routeWatcher:null,windowHeight:null,chartBaseURL:"/static/build/chart.html?v=2.9.10",chartLegacyBaseURL:"/static/build/chart-legacy.html?v=2.9.10",order:{}}},beforeCreate(){this.userId=Object(l["b"])(null,"user_id",l["c"]),this.publicToken=Object(l["b"])(null,"public_token",l["c"]),this.instrumentManager=new f["a"].InstrumentManager,s.e("chunk-2d22c101").then(s.t.bind(null,"f243",3)).then(t=>{this.instrumentManager.init(t),this.isInstrumentsLoaded=!0}),this.crosstabClient=h.a.client(),this.ticker=new z(this.crosstabClient),this.chartURLFragment="#token={token}&symbol={tradingsymbol}&segment={segment}&volume=true&enctoken={encToken}&user_id={userId}&access_token={accessToken}&api_key={apiKey}&source={source}&sdk={sdk}&theme={theme}"},created(){Object(A["m"])("resize","optimizedResize");let t=this.$route.query;"object"===typeof t&&0!==Object.keys(t).length?t.hasOwnProperty("source")&&"mobile"===t["source"]?this.enableDrawer=!1:t.hasOwnProperty("theme")&&t.theme!==this.theme&&this.$router.replace(this.$route.path+"?theme="+this.theme):"default"!==this.theme&&this.$router.replace(this.$route.path+"?theme="+this.theme),this.enableDrawer&&(this.fetchPositions(),this.fetchOrders())},mounted(){let t=this.instrumentManager.get(this.tradingsymbol,this.segment);this.updateChartURL({token:parseInt(this.token),segment:this.segment,tradingsymbol:this.tradingsymbol,tickSize:t&&t.tickSize}),this.crosstabClient.on(d["c"].CROSSTAB_CHANNELS.ticks,t=>{}),this.crosstabClient.on(d["c"].CROSSTAB_CHANNELS.refetch,t=>{this.refetchCurrentRouteData()}),this.crosstabClient.on(d["c"].CROSSTAB_CHANNELS.masterDisconnect,()=>{this.ticker.resubscribe()}),this.enableDrawer&&(this.$events.on(b["a"].constants.EVENTS.ORDER_PLACE_SUCCESS,this.onOrderEvent),this.$events.on(b["a"].constants.EVENTS.ORDER_MODIFY_SUCCESS,this.onOrderEvent),this.$events.on(b["a"].constants.EVENTS.ORDER_CANCEL_SUCCESS,this.onOrderEvent)),this.setPageTitle(this.tradingsymbol,this.segment),this.$nextTick(()=>{this.chartFrame=this.$el.querySelector("#chart-iframe"),this.chartFrame?this.chartFrame.addEventListener("load",t=>{setTimeout(()=>{console.log("chart.vue chartLoad: ",this.chartFrame.contentWindow.setLiveTicks),this.chartFrame.contentWindow.kiteAPI={openOrderWindow:this.openOrderWindow,openModifyOrderWindow:this.openModifyOrderWindow,openCancelOrderWindow:this.showOrderCancelModal,positions:this.positions,pendingOrders:this.formatOrders(this.pendingOrders),orders:this.orders,subscribeTicks:this.subscribeTicksCallback,unsubscribeTicks:this.unsubscribeTicksCallback,changeSymbol:null,onChangeSymbol:this.onChangeSymbol,instrumentManager:this.instrumentManager,alertWindow:this.$toast},window.chartFrame=this.chartFrame,window.setLiveTicks=this.chartFrame.contentWindow.setLiveTicks,window.kiteAPI={},window.kiteAPI.refreshCurrentChart=this.chartFrame.contentWindow.refreshCurrentChart,window.kiteAPI.changeSymbol=this.chartFrame.contentWindow.changeSymbolFromParent,this.chartFrame.contentWindow.dispatchEvent(new CustomEvent("chartLoadFinish",{})),this.chartFrame.contentWindow.addEventListener("reload",t=>{window.location.reload()})},2e3)}):console.log("chart.vue: chartFrame unavailable.")})},beforeDestroy(){this.enableDrawer&&(this.$events.off(b["a"].constants.EVENTS.ORDER_PLACE_SUCCESS,this.onOrderEvent),this.$events.off(b["a"].constants.EVENTS.ORDER_MODIFY_SUCCESS,this.onOrderEvent),this.$events.off(b["a"].constants.EVENTS.ORDER_CANCEL_SUCCESS,this.onOrderEvent))},watch:{$route(){this.setPageTitle(this.tradingsymbol,this.segment),this.updateChartURL(this.$route.params)},ticks(t){t[this.token]&&t[this.token].lastPrice&&t[this.token].lastPrice!==this.lastPrice&&(this.lastPrice=t[this.token].lastPrice,this.setPageTitle(this.tradingsymbol,this.segment,this.lastPrice)),t[this.token]&&this.chartFrame&&this.chartFrame.contentWindow&&this.chartFrame.contentWindow.setLiveTicks&&this.chartFrame.contentWindow.setLiveTicks({[this.token]:t[this.token]})},positions(t){if(t&&t.net&&t.net.length>0)for(let e of t.net)this.subscribedTokens.add(e.instrument_token);this.subscribeLTP(this.subscribedTokens)},pendingOrders(t){if(t&&t.length>0)for(let e of t)this.subscribedTokens.add(e.instrument_token);this.chartFrame.contentWindow.kiteAPI&&(this.chartFrame.contentWindow.kiteAPI.pendingOrders=this.formatOrders(t),this.chartFrame.contentWindow.kiteAPI.updateChart()&&this.chartFrame.contentWindow.kiteAPI.updateChart()),this.subscribeLTP(this.subscribedTokens)},orders(t){this.chartFrame.contentWindow.kiteAPI&&(this.chartFrame.contentWindow.kiteAPI.orders=t,this.chartFrame.contentWindow.retoggleEvents())}},computed:x(x(x(x(x(x({},Object(u["c"])(["theme"])),Object(u["c"])(g["a"].namespace,["ticks"])),Object(u["c"])(p["a"].namespace,["tours","toursFetchStatus"])),Object(u["c"])(k["a"].namespace,["positions","positionsFetchStatus"])),Object(u["c"])(b["a"].namespace,["orders","pendingOrders","completedOrders"])),{},{chartURL(){if(!this.chartParams||!this.chartParams.token)return null;let t=this.chartURLFragment;return"externalChart"===this.$route.name?t+="&full=true":t+="&inapp=true",this.$route.query.source&&"mobile"===this.$route.query.source.toLowerCase()?this.chartLegacyBaseURL+o()(t,this.chartParams):this.chartBaseURL+o()(t,this.chartParams)},customClass(){let t=!0,e=!1;return"externalChart"===this.$route.name&&(e=!0,t=!1),{"full-chart":e,inapp:t}},showInstrumentInfo(){return!("externalChart"===this.$route.name||!this.ticks[this.token])},instrument(){if(this.tradingsymbol&&this.segment)return this.instrumentManager.get(this.tradingsymbol,this.segment)},marketDepthData(){return{instrument:this.instrument,instrumentToken:this.token,tag:"chart-marketdepth"}},currentTick(){if(this.token&&this.ticks&&this.ticks[this.token])return this.ticks[this.token]},positionsCount(){return this.positions&&this.positions.net&&this.positions.net.length>0?this.positions.net.length:0},pendingOrdersCount(){return this.pendingOrders&&this.pendingOrders.length>0?this.pendingOrders.length:0}}),methods:x(x(x({},Object(u["b"])(k["a"].namespace,["fetchPositions"])),Object(u["b"])(b["a"].namespace,["fetchOrders","fetchTrades","fetchGTT"])),{},{apiOrderPlace(t){$.placeOrder(t).then(t=>{this.orderPlaceCallback(t,null)}).catch(t=>{this.orderPlaceCallback(null,t)})},apiOrderModify(t,e){$.modifyOrder(t,e).then(t=>{this.orderModifyCallback(t,null)}).catch(t=>{this.orderModifyCallback(null,t)})},orderPlaceCallback(t,e){if(t){let e=t.data.data.order_id;this.$events.emit(b["a"].constants.EVENTS.ORDER_PLACE_SUCCESS,x(x({},this.order),{},{orderId:e})),this.$toast.info({class:"order-toast",title:"Placed",message:this.order.transaction_type+" "+this.order.tradingsymbol+" is placed.<br />Check the orderbook for status.<br /><span class='order-id'>#"+t.data.data.order_id+"</span>",orientation:this.$toast.BOTTOM_RIGHT,update:!1,id:t.data.data.order_id,onClick:()=>{this.$router.push({name:"orders"})}})}else if(e){let t=Object(A["g"])(e);if(this.$events.emit(b["a"].constants.EVENTS.ORDER_PLACE_ERROR,x(x({},this.order),{},{error:t})),502===t.status_code||503===t.status_code||504===t.status_code){"orders"===this.$route.name&&this.$events.emit(d["c"].EVENTS.refetch+this.$route.name);let e=t.message+"<br />Please check the orderbook before placing the order again.";this.$toast.warning({title:"Error",message:e,orientation:this.$toast.BOTTOM_RIGHT,duration:6e3})}else this.$toast.error({title:"Error",message:t.message,orientation:this.$toast.BOTTOM_RIGHT,duration:6e3})}},orderModifyCallback(t,e){if(t)this.$events.emit(b["a"].constants.EVENTS.ORDER_MODIFY_SUCCESS,this.order),this.$toast.success({title:"Request sent",message:"Order modification request has been sent.",orientation:this.$toast.BOTTOM_RIGHT});else if(e){let t=Object(A["g"])(e);this.$events.emit(b["a"].constants.EVENTS.ORDER_MODIFY_ERROR,x(x({},this.order),{},{error:t})),this.$toast.error({title:"Error",message:t.message,orientation:this.$toast.BOTTOM_RIGHT})}},orderCancelCallback(t,e){if(t){let e=t&&t.data&&t.data.data;this.$events.emit(b["a"].constants.EVENTS.ORDER_CANCEL_SUCCESS,e)}else if(e){let t=Object(A["g"])(e);this.$events.emit(b["a"].constants.EVENTS.ORDER_CANCEL_ERROR,t)}},formatOrders(t){let e={};if(t){let s=1;for(let r of t)"CO"!==r.product.toUpperCase()&&(this.subscribedTokens.add(r.instrument_token),e.hasOwnProperty(r.tradingsymbol)||(e[r.tradingsymbol]=[]),r["action"]=r.transaction_type.toLowerCase(),r["id"]=s,s++,"LIMIT"===r.order_type?r["limit"]=r.price:"SL"!==r.order_type&&"SL-M"!==r.order_type||(r["stop"]=r.trigger_price),r["tif"]=r.product,r["currency"]="INR",e[r.tradingsymbol].push(r))}return e},openOrderWindow(t,e){let s="MARKET",r=t.limit;t.stop&&(r=t.stop),"BUY"===t.action.toUpperCase()?r<(this.currentTick&&this.currentTick.lastPrice)?s="LIMIT":r>(this.currentTick&&this.currentTick.lastPrice)&&(s="SL-M"):r>(this.currentTick&&this.currentTick.lastPrice)?s="LIMIT":r<(this.currentTick&&this.currentTick.lastPrice)&&(s="SL-M"),t.stop&&(t["triggerPrice"]=t.stop,r=0),e&&(s="MARKET"),"MIS"===t.tif?t.product=b["a"].constants.PRODUCT.MIS:"CNC"===t.tif?t.product=b["a"].constants.PRODUCT.CNC:"NRML"===t.tif&&(t.product=b["a"].constants.PRODUCT.NRML);let i={exchange:this.instrument.exchange.toUpperCase(),tradingsymbol:this.instrument.tradingsymbol.toUpperCase(),transaction_type:t.action.toUpperCase(),order_type:s.toUpperCase(),quantity:parseInt(t.quantity).toString(),price:parseFloat(r||0).toString(),product:t.product.toUpperCase(),validity:"DAY",disclosed_quantity:parseInt(t.disclosedQuantity||0).toString(),trigger_price:parseFloat(t.triggerPrice||0).toString(),squareoff:parseFloat(t.squareoff||0).toString(),stoploss:parseFloat(t.stoploss||0).toString(),trailing_stoploss:parseFloat(t.trailingStoploss||0).toString(),variety:t.variety||"regular",user_id:t.userId||this.userId,tag:"tfc"};this.order=i,this.apiOrderPlace(i)},openModifyOrderWindow(t){t.limit?(t.price=t.limit,t.order_type="LIMIT"):t.stop&&(t.trigger_price=t.stop,t.price=t.lastPrice,t.order_type="SL-M");let e=t.product.toUpperCase();e!==b["a"].constants.VARIETY.CO&&e!==b["a"].constants.VARIETY.BO||(e=b["a"].constants.PRODUCT.MIS),t["user_id"]=t.placed_buy,this.order=t,this.apiOrderModify(t.order_id,t)},showOrderCancelModal(t){this.$events.emit(C["b"].EVENTS.ORDER_CANCEL,t)},getInstrument(t,e){return this.instrumentManager.get(t,e)},updateChartURL(t){let e=this.getInstrument(t.tradingsymbol,t.segment),s={token:t.token,exchange:e&&e.exchange,tradingsymbol:encodeURIComponent(t.tradingsymbol),segment:t.segment,userId:this.userId,accessToken:this.$route.query.access_token,apiKey:this.$route.query.api_key,source:this.$route.query.source,sdk:this.$route.query.sdk,theme:this.$route.query.theme,encToken:this.encToken?encodeURIComponent(this.encToken):"",tickSize:e&&e.tickSize};this.chartParams=s,this.postIframeMessage(s)},postIframeMessage(t){this.chartFrame&&this.chartFrame.contentWindow&&this.chartFrame.contentWindow.kiteAPI&&this.chartFrame.contentWindow.kiteAPI.changeSymbol?this.chartFrame.contentWindow.kiteAPI.changeSymbol({token:t.token,segment:t.segment,symbol:decodeURIComponent(t.tradingsymbol),tickSize:t.tickSize}):this.chartFrame&&this.chartFrame.contentWindow&&this.chartFrame.contentWindow.location.reload()},subscribeTicksCallback(t){if(t&&t.token){let e=[parseInt(t.token)];this.ticker.subscribe(e,L["a"].NAMESPACE),this.ticker.setMode(this.ticker.modeFull,e,L["a"].NAMESPACE)}},unsubscribeTicksCallback(t){if(t&&t.token){let e=[parseInt(t.token)];this.ticker.unsubscribe(e,L["a"].NAMESPACE)}},placeOrderCallback(t){let e=this.instrumentManager.get(t.tradingsymbol.toUpperCase(),t.segment);this.$events.emit(C["b"].EVENTS.ORDER_PLACE,{instrument:e,transactionType:t.transactionType.toUpperCase(),quantity:e.lotSize||1,price:t.price||0,lastPrice:t.price||0})},onChangeSymbol(t){if(t.tradingsymbol!==this.tradingsymbol||t.segment!==this.segment){if(!t.tickSize){let e=this.getInstrument(t.tradingsymbol,t.segment);t.tickSize=e&&e.tickSize}"externalChart"===this.$route.name?this.$router.push({name:"externalChart",params:t}):"chart"===this.$route.name&&this.$router.push({name:"chart",params:t}),this.setPageTitle(t.tradingsymbol,t.segment)}},setPageTitle(t,e,s){let r=t+" ("+e+") ";s&&(r+=s),document.title=r+" - Kite Chart"},toggleDrawer(){this.showDrawer=!this.showDrawer;let t=window.innerWidth;this.$nextTick(()=>{this.showDrawer?(this.$el.querySelector(".chart-page").style.width=t-this.drawerWidth+"px",this.$el.querySelector(".drawer").style.width=this.drawerWidth+"px"):this.$el.querySelector(".chart-page").style.width=t+"px",this.showDrawer?(this.ticker.subscribe([this.token],B),this.ticker.setMode(this.ticker.modeFull,[this.token],B)):(this.ticker.subscribe([this.token],B),this.ticker.setMode(this.ticker.modeQuote,[this.token],B))})},placeOrder(t,e,s,r,i){let a={instrument:this.instrument,transactionType:t,orderType:e,product:i||"MIS",quantity:r||this.instrument.lotSize||1,disclosedQuantity:0,price:s,lastPrice:this.currentTick&&this.currentTick.lastPrice||0,stoplossPrice:0,squareoffPrice:0,trailingStoplossPrice:0};"SL-M"===e&&(a.triggerPrice=s),this.$events.emit(C["b"].EVENTS.ORDER_PLACE,a)},onOrderEvent(){this.refetchCurrentRouteData(),this.fetchOrders(),this.crosstabClient.emit(d["c"].CROSSTAB_CHANNELS.refetch,{client:"chart"})},refetchCurrentRouteData(t){this.$events.emit(d["c"].EVENTS.refetch+"orders"),this.$events.emit(d["c"].EVENTS.refetch+"positions")},subscribeLTP(t){this.ticker.subscribe(Array.from(t),B),this.ticker.setMode(this.ticker.modeLTP,Array.from(t),B)}})},G=H,Q=s("2877"),Y=Object(Q["a"])(G,r,i,!1,null,null,null);e["default"]=Y.exports},c2fb:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var r=s("7bdc");class i{}i.namespace=r["b"],i.install=function(t,e){e.store&&e.store.registerModule(r["b"],r["a"])}},c6c3:function(t,e,s){"use strict";var r=s("ba6a"),i=s("5665");function a(){return r["a"].get(Object(i["a"])("portfolio.positions.all"))}function n(t){return r["a"].put(Object(i["a"])("portfolio.positions.modify"),t)}e["a"]={getPositions:a,productModify:n}},dba6:function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));const r="positions",i={PRODUCT_MODIFY:r+".position.product.modify"};e["b"]={NAMESPACE:r,EVENTS:i}}}]);